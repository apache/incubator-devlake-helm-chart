{{- if and .Values.lake.encryptionSecret.autoCreateSecret (not .Values.lake.encryptionSecret.secret) }}
{{- fail "Helm test requires an encryption secret which can be acquired via cmd `openssl rand -base64 2000 | tr -dc 'A-Z' | fold -w 128 | head -n 1` "}}
{{- end }}

{{- if and .Values.ui.basicAuth.enabled .Values.ui.basicAuth.autoCreateSecret (or (not .Values.ui.basicAuth.user) (not .Values.ui.basicAuth.password)) }}
{{- fail "Helm test requires ui user/password"}}
{{- end }}

{{- if and (eq .Values.option.database "mysql") .Values.option.autoCreateSecret (or (not .Values.mysql.username) (not .Values.mysql.password) (not .Values.mysql.database)) }}
{{- fail "Helm test requires mysql username/password/database"}}
{{- end }}

{{- if and (not .Values.grafana.enabled) (not .Values.grafana.external.url) }}
{{- fail "Helm test requires grafana to be enabled or external grafana url to be provided"}}
{{- end }}
